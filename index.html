<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Időpontfoglalás – 2026</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  .slot {
    padding: 10px;
    margin: 6px 0;
    border: 1px solid #ccc;
    cursor: pointer;
    width: 220px;
  }
  .free { background-color: #b6fcb6; }
  .booked { background-color: #ff8a8a; cursor: not-allowed; }
  .names { font-size: 0.85em; margin-top: 5px; }
</style>
</head>
<body>

<h2>Időpontfoglalás – 2026</h2>

<label>Dátum:</label>
<input type="date" id="date" min="2026-01-01" max="2026-12-31">

<div id="slots"></div>

<script>
  const rules = {
    1: ["08:00", "09:00", "18:00", "19:00"], // hétfő
    3: ["08:00", "09:00", "18:00", "19:00"], // szerda
    5: ["18:00", "19:00"],                   // péntek
    0: ["19:00"]                              // vasárnap
  };

  const slotsDiv = document.getElementById("slots");
  const dateInput = document.getElementById("date");

  let bookings = JSON.parse(localStorage.getItem("bookings")) || {};

  // Maximum létszám szabály
  function getMax(day, time) {
    // szerda 19:00 → 4 fő
    if (day === 3 && time === "19:00") return 4;
    // minden más → 3 fő
    return 3;
  }

  dateInput.addEventListener("change", () => {
    const date = dateInput.value;
    slotsDiv.innerHTML = "";

    if (!date.startsWith("2026")) {
      slotsDiv.innerHTML = "<p>Csak 2026-os dátum választható.</p>";
      return;
    }

    const day = new Date(date).getDay();
    const times = rules[day];

    if (!times) {
      slotsDiv.innerHTML = "<p>Ezen a napon nincs foglalás.</p>";
      return;
    }

    times.forEach(time => {
      const key = date + "_" + time;
      if (!bookings[key]) bookings[key] = [];

      const MAX = getMax(day, time);

      const div = document.createElement("div");
      div.className = "slot " + (bookings[key].length >= MAX ? "booked" : "free");
      div.innerHTML = `<strong>${time}</strong> (${bookings[key].length}/${MAX})`;

      const namesDiv = document.createElement("div");
      namesDiv.className = "names";
      namesDiv.innerText = bookings[key].join(", ");
      div.appendChild(namesDiv);

      if (bookings[key].length < MAX) {
        div.onclick = () => {
          const name = prompt("Add meg a neved:");
          if (!name) return;

          bookings[key].push(name);
          localStorage.setItem("bookings", JSON.stringify(bookings));

          // újrarajzolás
          dateInput.dispatchEvent(new Event("change"));
        };
      }

      slotsDiv.appendChild(div);
    });
  });
</script>

</body>
</html>
